export class SwIconElement extends HTMLElement {
	static html = `
		<span id="container"></span>
	`

	static css = `
		:host, #container, svg {
			inline-size: 1em;
			block-size: 1em;
			overflow: visible;
			fill: currentColor;
		}

		.unknown {
			position: relative;
			display: inline-block;
			background: #ff00ff;
			inline-size: 1em;
			block-size: 1em;
		} .unknown::before {
			content: "";
			position: absolute;
			inset: 0 50% 50% 0;
			background: #8800ff;
		} .unknown::after {
			content: "";
			position: absolute;
			inset: 50% 0 0 50%;
			background: #8800ff;
		}
	`

	static get observedAttributes() {
		return ["name"]
	}

	static fromSymbol(symbol) {
		const elem = new SwIconElement()

		switch (symbol) {
			case "✷": elem.setAttribute("name", "success"); break;
			case "☋": elem.setAttribute("name", "advantage"); break;
			case "⦽": elem.setAttribute("name", "triumph"); break;
			case "▼": elem.setAttribute("name", "failure"); break;
			case "⬣": elem.setAttribute("name", "threat"); break;
			case "⎊": elem.setAttribute("name", "despair"); break;
			case "⬤": elem.setAttribute("name", "dark"); break;
			case "◯": elem.setAttribute("name", "light"); break;
			default: elem.setAttribute("name", "unknown"); break;
		}

		return elem
	}

	constructor() {
		super()

		this.#createRoot()
	}

	get name() { return this.getAttribute("name") }
	set name(value) { return this.setAttribute("name", value) }

	connectedCallback() {}

	attributeChangedCallback() {
		const container = this.shadowRoot.querySelector("#container")

		if (container != null) {
			container.innerHTML = this.#library[this.name] ?? this.#unknown()
		}
	}

	#library = {
		success: `<svg viewBox="0 0 24 24"><title>success</title><path d="M14.64,7.13l6.47-1.76-3.92,5.5,5.42,3.28-6.14,1,1.17,7.35L12.12,17,6.37,22.92l1.26-7.73-6.23-1L7.49,11,.74,3.57,10.2,8.08,12.12.17Zm.41,10.37-.62-3.78,3.33-.53-3.05-1.83L16.9,8.3l-3.4.92L12.39,6.13l-1.05,4.21L7.39,8.46l2.69,2.95-3.57,1.9,3.19.5-.64,3.9,3.06-3.11Z" transform="translate(0 0)"></path></svg>`,
		failure: `<svg viewBox="0 0 24 24"><title>failure</title><path d="M23.49,3.34a28.14,28.14,0,0,0-4.33,3.91,29.19,29.19,0,0,0-3.46,4.68A28.09,28.09,0,0,0,12,23.19a27.24,27.24,0,0,0-1.27-5.89,28.5,28.5,0,0,0-2.42-5.39A31.42,31.42,0,0,0,4.84,7.22,26.53,26.53,0,0,0,.51,3.34,29.44,29.44,0,0,0,6.05,5.15a27.47,27.47,0,0,0,6,.64,27.63,27.63,0,0,0,6-.64A28.4,28.4,0,0,0,23.49,3.34Z" transform="translate(0 0)"></path></svg>`,
		advantage: `<svg viewBox="0 0 24 24"><title>advantage</title><path d="M20.83,13.23a5.55,5.55,0,0,0,.7-.37,5.89,5.89,0,0,0,.93-.77,7.29,7.29,0,0,0,1-1.34l0,.35v.72A4.57,4.57,0,0,1,23,13.48,5.93,5.93,0,0,1,22,14.76,5.52,5.52,0,0,1,21,15.7c-.37.25-.72.45-1,.62s-.58.27-.79.33l-.33.12-.21.15,0,.27.23.19.53.18a2.88,2.88,0,0,0,.73,0,2.54,2.54,0,0,0,.83-.16l-.6.56q-.37.34-.87.72a11.65,11.65,0,0,1-1.16.79,10.34,10.34,0,0,1-1.41.75,15.93,15.93,0,0,1-1.6.58c-.54.16-1.05.29-1.51.39a7.52,7.52,0,0,1-1.16.15c-.31,0-.48,0-.52-.09v0H12l0,0c0,.06-.21.11-.52.09a7.52,7.52,0,0,1-1.16-.15c-.46-.1-1-.23-1.51-.39a15.93,15.93,0,0,1-1.6-.58,11.37,11.37,0,0,1-1.39-.75c-.43-.27-.83-.52-1.18-.79S4,18.23,3.71,18l-.6-.56a2.54,2.54,0,0,0,.83.16,3,3,0,0,0,.75,0l.53-.18.23-.19-.06-.27-.19-.15-.33-.12c-.2-.06-.45-.19-.79-.33s-.66-.37-1-.62A5.52,5.52,0,0,1,2,14.76,6.33,6.33,0,0,1,1,13.5,4.81,4.81,0,0,1,.5,11.82V11.1l0-.35a7.29,7.29,0,0,0,1,1.34,5.89,5.89,0,0,0,.93.77,4.4,4.4,0,0,0,.68.37l.33.1.34-.16,0-.39c-.13-.23-.25-.46-.4-.69s-.31-.45-.47-.7a3.89,3.89,0,0,1-.75-2,5.68,5.68,0,0,1,.25-2.47,4.23,4.23,0,0,1,.81-1.53A6,6,0,0,1,4.5,4.22,9.6,9.6,0,0,1,6,3.39C6.49,3.16,7,3,7.54,2.77h.17A4.62,4.62,0,0,0,6.38,3.91a3.44,3.44,0,0,0-.62,1.22A3.24,3.24,0,0,0,5.7,6.37,4.62,4.62,0,0,0,6,7.53a7.85,7.85,0,0,0,1.78,2.63,6.74,6.74,0,0,0-1,2.8A5.4,5.4,0,0,0,7,15.39a7,7,0,0,0,1.07,2,11.81,11.81,0,0,0,1.48,1.51,11.21,11.21,0,0,0,1.4,1c.44.25.73.42.9.5h.22c.17-.08.46-.25.89-.5a9.51,9.51,0,0,0,1.43-1,11.81,11.81,0,0,0,1.48-1.51,7,7,0,0,0,1.07-2A5.8,5.8,0,0,0,17.22,13a6.91,6.91,0,0,0-1-2.82A7.85,7.85,0,0,0,18,7.53a4.62,4.62,0,0,0,.31-1.16,3.24,3.24,0,0,0-.06-1.24,3.44,3.44,0,0,0-.62-1.22,4.49,4.49,0,0,0-1.33-1.14h.19c.51.18,1,.39,1.55.62a9.15,9.15,0,0,1,1.47.83A6,6,0,0,1,20.7,5.36a4.56,4.56,0,0,1,.81,1.53,5.56,5.56,0,0,1,.25,2.45A4.22,4.22,0,0,1,21,11.39c-.17.25-.34.47-.48.7a6.37,6.37,0,0,0-.42.69l.05.39.33.16ZM12,8.9a2,2,0,0,1-.87-.17,2.6,2.6,0,0,1-.73-.49,2.08,2.08,0,0,1-.47-.75,2.18,2.18,0,0,1,0-1.78A2.26,2.26,0,0,1,10.4,5a2.6,2.6,0,0,1,.73-.49,2.31,2.31,0,0,1,1.74,0A2.6,2.6,0,0,1,13.6,5a2.26,2.26,0,0,1,.47.75,2.18,2.18,0,0,1,0,1.78,2.08,2.08,0,0,1-.47.75,2.6,2.6,0,0,1-.73.49A2,2,0,0,1,12,8.9Z" transform="translate(0 0)"></path></svg>`,
		threat: `<svg viewBox="0 0 24 24"><title>threat</title><path d="M4.61,10.94H1.4L5.68,3.51,7.35,6.34Zm0,2.35L7.3,17.9,5.68,20.73,1.4,13.29ZM14.7,7.5l2.62,4.63L14.7,16.76H9.31L6.67,12.13,9.31,7.5ZM9.31,5.17,7.69,2.34h8.6L14.7,5.17ZM14.7,19.06l1.59,2.86H7.69l1.62-2.86Zm.47-6.93L13.6,9.35H10.38L8.81,12.13l1.57,2.76H13.6Zm4.18-1.19-2.69-4.6,1.66-2.83,4.29,7.43Zm0,2.35h3.26l-4.29,7.44L16.66,17.9Z" transform="translate(0 0)"></path></svg>`,
		triumph: `<svg viewBox="0 0 24 24"><title>triumph</title><path d="M19.82,15.06a7.54,7.54,0,0,1-1.31,2.35,7.94,7.94,0,0,1-2,1.74l.77,1-1.09-.82a7.37,7.37,0,0,1-1.59.72,9.12,9.12,0,0,1-1.74.37V21.7l-1.75.49V20.46a8,8,0,0,1-2.93-.89A8.45,8.45,0,0,1,5.8,17.74a8.94,8.94,0,0,1-1.61-2.56,8.27,8.27,0,0,1-.58-3.08A7.79,7.79,0,0,1,4.23,9,8.05,8.05,0,0,1,5.9,6.38,8.28,8.28,0,0,1,8.38,4.55a7.82,7.82,0,0,1,3-.79L11.55.18h.87l.12,3.58a8.11,8.11,0,0,1,3.08.79A8.54,8.54,0,0,1,18.1,6.38,8,8,0,0,1,19.76,9a7.79,7.79,0,0,1,.62,3.12A7.71,7.71,0,0,1,20,14.7l1.37.22ZM11.39,4.71a7.28,7.28,0,0,0-2.68.74,7.45,7.45,0,0,0-2.14,1.6A7.64,7.64,0,0,0,5.1,9.36a7.23,7.23,0,0,0-.53,2.74,7.33,7.33,0,0,0,.51,2.7,7.85,7.85,0,0,0,1.39,2.29A7.49,7.49,0,0,0,8.55,18.7a7.82,7.82,0,0,0,2.56.81v-2.9l-.1-.44L8.14,17.64l2-2.82L5.58,11.76l5.49,1.47ZM19,14.54a6.64,6.64,0,0,0,.43-2.44,7.07,7.07,0,0,0-.53-2.76,7.44,7.44,0,0,0-1.45-2.29,6.92,6.92,0,0,0-2.18-1.6,7.23,7.23,0,0,0-2.7-.74l.3,7.81,3.89-2.86-2.86,4.05Zm-6.15,5a7.25,7.25,0,0,0,1.29-.28,6.67,6.67,0,0,0,1.21-.49l-2.5-1.93ZM16,18.42A7.79,7.79,0,0,0,17.6,17a6.86,6.86,0,0,0,1.19-1.83l-5,.4Z" transform="translate(0 0)"></path></svg>`,
		despair: `<svg viewBox="0 0 24 24"><title>despair</title><path d="M19.52,8.43a8.21,8.21,0,0,1,.85,3.7,8.36,8.36,0,0,1-7.89,8.35A23.22,23.22,0,0,0,12,23.35a23.2,23.2,0,0,0-.47-2.87,8.38,8.38,0,0,1-7-12.07A23.44,23.44,0,0,0,2.32,6.62a23.06,23.06,0,0,0,2.62,1,8.4,8.4,0,0,1,14.13,0,19.16,19.16,0,0,0,2.61-1A24.93,24.93,0,0,0,19.52,8.43Zm-8.23,11.1c-.12-.38-.22-.78-.36-1.15a24.23,24.23,0,0,0-2-4.52A26,26,0,0,0,6,9.89L5.2,9.1a7.61,7.61,0,0,0-.64,3A7.44,7.44,0,0,0,11.29,19.53ZM5.89,7.89c.36.1.72.18,1.09.26a21.76,21.76,0,0,0,5,.55,22.79,22.79,0,0,0,5-.53c.38-.08.74-.18,1.09-.28a7.45,7.45,0,0,0-12.22,0Zm13.55,4.24a7.68,7.68,0,0,0-.63-3L18,9.91a26,26,0,0,0-2.91,4,23.51,23.51,0,0,0-2,4.5c-.13.37-.23.77-.35,1.15A7.43,7.43,0,0,0,19.44,12.13Z" transform="translate(0 0)"></path></svg>`,
		light: `<svg viewBox="0 0 24 24"><title>light</title><g><circle cx="12" cy="12" r="7.5" fill="#fff"></circle><path d="M12,5a7,7,0,1,1-7,7,7,7,0,0,1,7-7m0-1a8,8,0,1,0,8,8,8,8,0,0,0-8-8Z" transform="translate(0 0)" fill="#111"></path></g></svg>`,
		dark: `<svg viewBox="0 0 24 24"><title>dark</title><g><path d="M12,19.5A7.5,7.5,0,1,1,19.5,12,7.5,7.5,0,0,1,12,19.5Z" transform="translate(0 0)" fill="#111"></path><path d="M12,5a7,7,0,1,1-7,7,7,7,0,0,1,7-7m0-1a8,8,0,1,0,8,8,8,8,0,0,0-8-8Z" transform="translate(0 0)" fill="#fff"></path></g></svg>`,
	}

	#unknown = () => `<span class="unknown"></span>`

	#createRoot = () => {
		const root = this.shadowRoot ?? this.attachShadow({ mode: "open" })

		const style = document.createElement("style")
		style.innerHTML = SwIconElement.css

		const template = document.createElement("template")
		template.innerHTML = SwIconElement.html

		root.appendChild(style)
		root.appendChild(template.content)

		return root
	}
}

customElements.define("sw-icon", SwIconElement)